<script>
function postMsg(msg){
    var request = new XMLHttpRequest();
    request.open("POST", "/log.php");
    request.setRequestHeader("Content-Type", "text/plain; charset=UTF-8");
    request.send(msg);
}
function getText(url, callback){
    var request.new XMLHttpRequest();
    request.open("GET", url);
    request.onreadystatechange = function(){
        if(request.readyState===4 && request.status===200){
            var type = request.getResponseHeader("Content-Type");
            if(type.match(/^text/)){
                callback(request.responseText);
            }
        }
    }
    request.send(null);
}
function jsonP(url, data, callback){
    var request = new XMLHttpRequest();
    request.open("GET", url);
    request.onreadystatechange = function(){
        if(request.readyState===4 && request.status===200){
            var type = request.getResponseHeader("Content-Type");
            if(type.match(/^text/)){
                callback(request.responseText);
            }
        }
    }
    request.setRequestHeader("Content-Type", "application/json");
    request.send(JSON.stringify(data));

}
window.onload = function(){
    var supportsCORS = (new XMLHttpRequest()).withCredentials !== undefined;
    //....
}
</script>